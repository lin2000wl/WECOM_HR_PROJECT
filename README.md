# ä¼ä¸šå¾®ä¿¡æ™ºèƒ½æ‹›è˜æœºå™¨äºº

åŸºäº Pythonã€ä¼ä¸šå¾®ä¿¡è‡ªå»ºåº”ç”¨æ¡†æ¶å’Œ DeepSeek LLM çš„æ™ºèƒ½æ‹›è˜åŠ©ç†ï¼Œæ—¨åœ¨è‡ªåŠ¨åŒ–æ‹›è˜æµç¨‹ä¸­çš„å€™é€‰äººç­›é€‰ã€åˆæ­¥è”ç³»å’Œç®€å†ç®¡ç†ã€‚

> **æ³¨æ„ï¼š** æœ¬é¡¹ç›®å·²ä»æ—©æœŸçš„ `wcferry` æ¡†æ¶è¿ç§»åˆ°ä¼ä¸šå¾®ä¿¡è‡ªå»ºåº”ç”¨æ¡†æ¶ï¼Œæä¾›æ›´ç¨³å®šã€æ›´å®‰å…¨çš„ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆã€‚

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ™ºèƒ½æ‹›è˜è§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«ä»¥ä¸‹æ ¸å¿ƒç»„ä»¶ï¼š
1. **åœ¨çº¿ç”¨æˆ·äº¤äº’æµç¨‹** - é€šè¿‡ä¼ä¸šå¾®ä¿¡åº”ç”¨å¤„ç†æ‹›è˜æŸ¥è¯¢
2. **åå°ç®€å†å¤„ç†æµç¨‹** - è‡ªåŠ¨åŒ–å¤„ç†å’Œå…¥åº“PDFç®€å†
3. **URLéªŒè¯æœåŠ¡** - ç‹¬ç«‹çš„ä¼ä¸šå¾®ä¿¡å›è°ƒURLéªŒè¯æœåŠ¡
4. **ä»£ç†è½¬å‘æœåŠ¡** - HTTPä»£ç†è½¬å‘æœåŠ¡ï¼Œè§£å†³å†…ç½‘éƒ¨ç½²é—®é¢˜

## ä¸»è¦åŠŸèƒ½

### ğŸ¤– ä¼ä¸šå¾®ä¿¡æ™ºèƒ½äº¤äº’
*   **ä¼ä¸šå¾®ä¿¡é›†æˆ:** åŸºäº FastAPI æ„å»ºçš„å›è°ƒæœåŠ¡å™¨ï¼Œæ”¯æŒä¼ä¸šå¾®ä¿¡æ¶ˆæ¯åŠ è§£å¯†ã€ç­¾åæ ¡éªŒ
*   **å¤šåœºæ™¯æ”¯æŒ:** æ”¯æŒç§èŠå’Œç¾¤èŠ@æœºå™¨äººä¸¤ç§äº¤äº’æ–¹å¼
*   **å¹¶å‘å¤„ç†:** ä½¿ç”¨çº¿ç¨‹æ± å®ç°å¤šç”¨æˆ·å¹¶å‘æŸ¥è¯¢ï¼Œå“åº”è¿…é€Ÿ
*   **çŠ¶æ€ç®¡ç†:** å¸¦TTLçš„ä¼šè¯çŠ¶æ€ç®¡ç†ï¼Œæ”¯æŒ3åˆ†é’Ÿè¶…æ—¶è‡ªåŠ¨æ¸…ç†

### ğŸ§  æ™ºèƒ½æŸ¥è¯¢ç†è§£
*   **è‡ªç„¶è¯­è¨€è§£æ:** åˆ©ç”¨ DeepSeek LLM è§£æå¤æ‚çš„æ‹›è˜æŸ¥è¯¢æŒ‡ä»¤
*   **é«˜çº§è¯­ä¹‰ç†è§£:**
    *   **å­¦å†èŒƒå›´:** ç†è§£"æœ¬ç§‘ä»¥ä¸Š"ã€"ç¡•å£«åŠä»¥ä¸Š"ç­‰èŒƒå›´è¡¨è¾¾
    *   **å­¦å†åŒä¹‰è¯:** è‡ªåŠ¨æ‰©å±•"æœ¬ç§‘"/"å­¦å£«"ç­‰åŒä¹‰è¯
    *   **å…¬å¸ç»éªŒ:** æå–å¹¶æ¨¡ç³ŠåŒ¹é…è¿‡å¾€å…¬å¸åç§°
    *   **è¯ä¹¦/èŒç§°ç­‰çº§:** æ”¯æŒ"ä¸­çº§å·¥ç¨‹å¸ˆåŠä»¥ä¸Š"ã€"ä¸€çº§å»ºé€ å¸ˆ"ç­‰å¤æ‚æŸ¥è¯¢
    *   **èŒä½/è¯ä¹¦æ­§ä¹‰:** æ™ºèƒ½åŒºåˆ†æŸ¥è¯¢æ„å›¾
    *   **è®¾è®¡ç±»åˆ«:** è¯†åˆ«"å»ºç­‘è®¾è®¡"ã€"ç”µæ°”è®¾è®¡"ã€"ç»™æ’æ°´è®¾è®¡"ç­‰ä¸“ä¸šåˆ†ç±»

### ğŸ¯ æ™ºèƒ½ç­›é€‰ä¸æ’åº
*   **å¤šç»´åº¦è¯„åˆ†:** åŸºäºç»éªŒã€æŠ€èƒ½ã€åœ°ç‚¹ã€è¯ä¹¦ã€å­¦å†ç­‰ç»´åº¦è¿›è¡Œç»¼åˆè¯„åˆ†
*   **é…ç½®åŒ–è§„åˆ™:** é€šè¿‡ `config.yaml` çµæ´»é…ç½®è¯„åˆ†æƒé‡å’Œé€»è¾‘
*   **æ™ºèƒ½æ’åº:** è¿”å›è¯„åˆ†æœ€é«˜çš„Top Nå€™é€‰äºº
*   **AIæ‘˜è¦ç”Ÿæˆ:** è‡ªåŠ¨ç”Ÿæˆå€™é€‰äººå¯¹æ¯”åˆ†ææ‘˜è¦

### ğŸ“‹ äº¤äº’å¼ç»“æœå±•ç¤º
*   **ç»“æ„åŒ–å±•ç¤º:** æ¸…æ™°å±•ç¤ºå€™é€‰äººå…³é”®ä¿¡æ¯å’ŒAIåˆ†ææ‘˜è¦
*   **æŒ‰éœ€æ“ä½œ:** æ”¯æŒå¤šç§åç»­æ“ä½œ
    *   `ç®€å† X` - è·å–å€™é€‰äººç®€å†PDFæ–‡ä»¶
    *   `ä¿¡æ¯ X` - æŸ¥çœ‹å€™é€‰äººè¯¦ç»†ä¿¡æ¯
    *   `è”ç³» X` - è‡ªåŠ¨å‘é€åˆæ­¥æ²Ÿé€šæ¶ˆæ¯
    *   `A` - æŸ¥çœ‹æ›´å¤šç¬¦åˆæ¡ä»¶çš„å€™é€‰äºº
    *   `B` - ç»“æŸå½“å‰æŸ¥è¯¢

### ğŸ‘¥ å¤–éƒ¨è”ç³»äººåŒæ­¥
*   **æ‰¹é‡è·å–:** é€šè¿‡ä¼ä¸šå¾®ä¿¡APIæ‰¹é‡è·å–HRåä¸‹çš„å¤–éƒ¨è”ç³»äººä¿¡æ¯
*   **æ™ºèƒ½åŒ¹é…:** æ ¹æ®å¤–éƒ¨è”ç³»äººçš„æ‰‹æœºå·è‡ªåŠ¨åŒ¹é…å†…éƒ¨æ•°æ®åº“ä¸­çš„å€™é€‰äººè®°å½•
*   **æ•°æ®åŒæ­¥:** å°†åŒ¹é…æˆåŠŸçš„å¤–éƒ¨è”ç³»äººIDæ›´æ–°åˆ°å†…éƒ¨æ•°æ®åº“
*   **æ ‡ç­¾ç®¡ç†:** ä¸ºæˆåŠŸåŒæ­¥çš„å¤–éƒ¨è”ç³»äººè‡ªåŠ¨æ‰“ä¸Š"å·²åŒæ­¥"æ ‡ç­¾
*   **è§¦å‘æ–¹å¼:** æ”¯æŒæ‰‹åŠ¨æŒ‡ä»¤è§¦å‘å’Œå®šæ—¶è‡ªåŠ¨åŒæ­¥ä¸¤ç§æ¨¡å¼
*   **ç»“æœé€šçŸ¥:** åŒæ­¥å®Œæˆåè‡ªåŠ¨å‘é€ç»Ÿè®¡æŠ¥å‘Šå’Œå¤±è´¥åˆ—è¡¨

### ğŸ“„ åå°ç®€å†å¤„ç†
*   **è‡ªåŠ¨åŒ–æµç¨‹:** æ‰«æã€æå–ã€è§£æã€æ ¡éªŒã€å…¥åº“ä¸€ä½“åŒ–
*   **å¤šæ ¼å¼æ”¯æŒ:** PDFæ–‡æœ¬æå– + OCRå¤‡é€‰æ–¹æ¡ˆ
*   **æ™ºèƒ½è§£æ:** LLMæå–ç»“æ„åŒ–ç®€å†ä¿¡æ¯
*   **æ–‡ä»¶ç®¡ç†:** è‡ªåŠ¨åˆ†ç±»å¤„ç†ï¼ˆæˆåŠŸ/å¤±è´¥/å¾…å¤„ç†ï¼‰
*   **æ•°æ®å…¥åº“:** MongoDBå­˜å‚¨ï¼Œæ”¯æŒUpsertæ“ä½œ

### ğŸ” URLéªŒè¯æœåŠ¡ (`url_verification/`)
*   **ç‹¬ç«‹éªŒè¯æœåŠ¡:** åŸºäºFlaskçš„ä¼ä¸šå¾®ä¿¡å›è°ƒURLéªŒè¯æœåŠ¡
*   **åŠ å¯†è§£å¯†:** å®Œæ•´çš„ä¼ä¸šå¾®ä¿¡æ¶ˆæ¯åŠ è§£å¯†åŠŸèƒ½
*   **å¤šç«¯ç‚¹æ”¯æŒ:** æ”¯æŒå¤šç§å›è°ƒè·¯å¾„é…ç½®
*   **è°ƒè¯•å‹å¥½:** è¯¦ç»†çš„è¯·æ±‚æ—¥å¿—å’Œé”™è¯¯å¤„ç†
*   **å¿«é€Ÿéƒ¨ç½²:** ç‹¬ç«‹è¿è¡Œï¼Œä¾¿äºæµ‹è¯•å’Œè°ƒè¯•

### ğŸŒ ä»£ç†è½¬å‘æœåŠ¡ (`wework_proxy_app/`)
*   **é€æ˜ä»£ç†:** HTTPè¯·æ±‚é€æ˜è½¬å‘ï¼Œä¿æŒæ•°æ®å®Œæ•´æ€§
*   **è·¯å¾„æ˜ å°„:** è‡ªåŠ¨å¤„ç†`/wework-callback/*`è·¯å¾„è½¬å‘
*   **é”™è¯¯å¤„ç†:** å®Œå–„çš„è¶…æ—¶å’Œè¿æ¥é”™è¯¯å¤„ç†æœºåˆ¶
*   **ç”Ÿäº§å°±ç»ª:** æ”¯æŒè´Ÿè½½å‡è¡¡å’Œåå‘ä»£ç†é…ç½®
*   **å†…ç½‘ç©¿é€:** è§£å†³ä¼ä¸šå¾®ä¿¡å›è°ƒURLå¿…é¡»å…¬ç½‘è®¿é—®çš„é—®é¢˜

## æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ
*   **åç«¯æ¡†æ¶:** FastAPI + Uvicorn (ASGIæœåŠ¡å™¨)
*   **ä¼ä¸šå¾®ä¿¡é›†æˆ:** httpx (APIè°ƒç”¨) + WXBizMsgCrypt (æ¶ˆæ¯åŠ è§£å¯†)
*   **è‡ªç„¶è¯­è¨€å¤„ç†:** DeepSeek LLM API (é€šè¿‡ openai SDK)
*   **æ•°æ®åº“:** MongoDB + pymongo é©±åŠ¨
*   **å¹¶å‘å¤„ç†:** Python threading.ThreadPoolExecutor
*   **çŠ¶æ€ç®¡ç†:** cachetools.TTLCache (çº¿ç¨‹å®‰å…¨)

### æ–‡æ¡£å¤„ç†
*   **PDFå¤„ç†:** PyPDF2/pdfminer.six (æ–‡æœ¬æå–) + pdf2image + Pillow
*   **OCRå¼•æ“:** pytesseract (Tesseract OCR PythonåŒ…è£…å™¨)
*   **é…ç½®ç®¡ç†:** PyYAML + python-dotenv
*   **æ—¥å¿—ç³»ç»Ÿ:** Python loggingæ¨¡å—

### æ•°æ®æ¨¡å‹
*   **å€™é€‰äººä¿¡æ¯:** åŸºæœ¬ä¿¡æ¯ã€å·¥ä½œç»å†ã€æ•™è‚²èƒŒæ™¯ã€æŠ€èƒ½è¯ä¹¦
*   **æŸ¥è¯¢æ ‡ç­¾:** ä¼˜åŒ–çš„æ£€ç´¢å­—æ®µï¼ˆpositions, skills, degrees, certificationsç­‰ï¼‰
*   **æ–‡ä»¶è·¯å¾„:** æ ‡å‡†åŒ–çš„ç®€å†æ–‡ä»¶å­˜å‚¨è·¯å¾„

## ç¯å¢ƒè¦æ±‚

### åŸºç¡€ç¯å¢ƒ
*   **æ“ä½œç³»ç»Ÿ:** Windows/Linux (æ¨èLinuxç”¨äºç”Ÿäº§éƒ¨ç½²)
*   **Python:** 3.8+ 
*   **MongoDB:** å¯è®¿é—®çš„MongoDBå®ä¾‹
*   **ä¼ä¸šå¾®ä¿¡:** å·²åˆ›å»ºçš„è‡ªå»ºåº”ç”¨å’Œé…ç½®çš„å›è°ƒURL

### å¯é€‰ç»„ä»¶
*   **Tesseract OCR:** å¤„ç†å›¾ç‰‡å‹PDF (éœ€å®‰è£…ä¸­æ–‡è¯­è¨€åŒ…)
*   **Poppler:** pdf2imageä¾èµ– (PDFè½¬å›¾ç‰‡)
*   **åå‘ä»£ç†:** Nginx/Caddy (ç”Ÿäº§ç¯å¢ƒæ¨è)

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/lin2000wl/WECOM_HR_PROJECT.git
cd HR_Project_Bot_2.0

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv .venv
# Windows
.\.venv\Scripts\activate
# Linux/Mac
source .venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. ä¼ä¸šå¾®ä¿¡é…ç½®
1. **åˆ›å»ºè‡ªå»ºåº”ç”¨:**
   - ç™»å½•ä¼ä¸šå¾®ä¿¡ç®¡ç†åå° â†’ åº”ç”¨ç®¡ç† â†’ è‡ªå»ºåº”ç”¨
   - è®°å½• CorpIDã€AgentIDã€Secret

2. **é…ç½®å›è°ƒ:**
   - è®¾ç½®å›è°ƒURL: `https://your_domain.com/api/v1/wecom/callback`
   - é…ç½®Tokenå’ŒEncodingAESKey
   - é…ç½®å¯ä¿¡IPç™½åå•

### 3. é…ç½®æ–‡ä»¶è®¾ç½®

åˆ›å»º `.env` æ–‡ä»¶ï¼š
```env
# ä¼ä¸šå¾®ä¿¡é…ç½®
WECOM_CORP_ID="your_corp_id"
WECOM_AGENT_ID="your_agent_id" 
WECOM_APP_SECRET="your_app_secret"
WECOM_CALLBACK_TOKEN="your_callback_token"
WECOM_CALLBACK_AES_KEY="your_callback_aes_key"

# LLMé…ç½®
DEEPSEEK_API_KEY="your_deepseek_api_key"
DEEPSEEK_API_BASE="https://api.deepseek.com"

# MongoDBé…ç½®
MONGO_URI="mongodb://localhost:27017/"
MONGO_DATABASE="hr_recruitment"

# æˆæƒç”¨æˆ·
AUTHORIZED_USER_IDS_EW="userid1,userid2"

# å¤–éƒ¨è”ç³»äººåŒæ­¥é…ç½®
TAG_ID_SYNC_SUCCESS="your_sync_success_tag_id"
SYNC_HR_USERIDS="hr_userid1,hr_userid2"
SYNC_SCHEDULE_CRON="0 * * * *"  # æ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œå¯é€‰
```

é…ç½® `config.yaml`ï¼š
```yaml
# è¯¦ç»†é…ç½®è¯·å‚è€ƒé¡¹ç›®ä¸­çš„config.yamlç¤ºä¾‹
database:
  mongodb:
    uri: "mongodb://localhost:27017/"
    database: "hr_recruitment"
    collection: "candidates"

llm:
  deepseek:
    query_model: "deepseek-chat"
    resume_model: "deepseek-chat"
    summary_model: "deepseek-chat"

paths:
  data: "./data"
  processed: "./processed_resumes"
  error: "./data/error"
  pending: "./data/pending"

cache:
  ttl_seconds: 180

scoring_rules:
  initial_candidate_pool_size: 30
  # ... å…¶ä»–è¯„åˆ†é…ç½®

# å¤–éƒ¨è”ç³»äººåŒæ­¥é…ç½®
external_contact_sync:
  enabled: true
  batch_size: 100
  sync_timeout_seconds: 300
```

### 4. å¯åŠ¨æœåŠ¡
```bash
# å¼€å‘ç¯å¢ƒ
python -m src.main_ew

# ç”Ÿäº§ç¯å¢ƒ (æ¨è)
uvicorn src.main_ew:app --host 0.0.0.0 --port 8502
```

### 5. å¯åŠ¨è¾…åŠ©æœåŠ¡

**URLéªŒè¯æœåŠ¡ (ç”¨äºä¼ä¸šå¾®ä¿¡å›è°ƒURLéªŒè¯):**
```bash
cd url_verification
pip install -r requirements.txt
cp env.example .env  # é…ç½®TOKEN, ENCODING_AES_KEY, CORP_ID
python start.py
# æˆ–ç›´æ¥è¿è¡Œ: python app.py
```

**ä»£ç†è½¬å‘æœåŠ¡ (ç”¨äºå†…ç½‘éƒ¨ç½²):**
```bash
cd wework_proxy_app
pip install -r requirements.txt
echo "TARGET_SERVER_URL=http://your-internal-server.com" > .env
python app.py
```

### 6. åå°ç®€å†å¤„ç†
```bash
# æ‰‹åŠ¨è§¦å‘ç®€å†å¤„ç†
python -m src.resume_pipeline.trigger
```

## ä½¿ç”¨ç¤ºä¾‹

### æŸ¥è¯¢ç¤ºä¾‹
**ç§èŠæŸ¥è¯¢:**
```
æ‰¾åŒ—äº¬åœ°åŒºçš„è½¯ä»¶å·¥ç¨‹å¸ˆï¼Œ5å¹´ä»¥ä¸Šç»éªŒï¼Œéœ€è¦ç²¾é€šPythonå’ŒDocker
æœç´¢ç¡•å£«åŠä»¥ä¸Šå­¦å†ï¼Œæœ‰åä¸ºæˆ–è…¾è®¯å·¥ä½œç»å†çš„ç®—æ³•ä¸“å®¶
ç»™æˆ‘æ¨èæœ‰PMPè¯ä¹¦çš„é¡¹ç›®ç»ç†
æ‰¾ä¸­çº§å·¥ç¨‹å¸ˆåŠä»¥ä¸Šï¼Œåšè¿‡ç”µæ°”è®¾è®¡çš„
æœ‰æ²¡æœ‰ä¸€çº§å»ºé€ å¸ˆï¼Ÿ
```

**ç¾¤èŠæŸ¥è¯¢ (éœ€è¦@æœºå™¨äºº):**
```
@æœºå™¨äºº æ‰¾æ·±åœ³åšåµŒå…¥å¼çš„ï¼Œæœ¬ç§‘ä»¥ä¸Šå­¦å†
@æœºå™¨äºº æœç´¢åœ¨æ’å¤§å¹²è¿‡çš„åœŸå»ºå·¥ç¨‹å¸ˆ
@æœºå™¨äºº éœ€è¦é«˜çº§èŒç§°çš„å»ºç­‘è®¾è®¡å¸ˆ
```

### äº¤äº’æµç¨‹
1. **å‘é€æŸ¥è¯¢** â†’ æœºå™¨äººè§£æå¹¶æœç´¢
2. **æ¥æ”¶ç»“æœ** â†’ Top Nå€™é€‰äººåˆ—è¡¨ + AIæ‘˜è¦
3. **åç»­æ“ä½œ:**
   - `ç®€å† 1` â†’ è·å–ç¬¬1ä½å€™é€‰äººç®€å†
   - `ä¿¡æ¯ 2` â†’ æŸ¥çœ‹ç¬¬2ä½å€™é€‰äººè¯¦æƒ…
   - `è”ç³» 3` â†’ è”ç³»ç¬¬3ä½å€™é€‰äºº
   - `A` â†’ æŸ¥çœ‹æ›´å¤šå€™é€‰äºº
   - `B` â†’ ç»“æŸæŸ¥è¯¢

### å¤–éƒ¨è”ç³»äººåŒæ­¥
**æ‰‹åŠ¨è§¦å‘åŒæ­¥:**
```
æ›´æ–°å¤–éƒ¨è”ç³»äºº
/sync_contacts
```

**è‡ªåŠ¨åŒæ­¥:**
- ç³»ç»Ÿæ ¹æ®é…ç½®çš„CRONè¡¨è¾¾å¼è‡ªåŠ¨æ‰§è¡Œ
- é»˜è®¤æ¯å°æ—¶åŒæ­¥ä¸€æ¬¡HRåä¸‹çš„å¤–éƒ¨è”ç³»äºº
- è‡ªåŠ¨åŒ¹é…æ‰‹æœºå·å¹¶æ›´æ–°æ•°æ®åº“
- ä¸ºæˆåŠŸåŒæ­¥çš„è”ç³»äººæ‰“ä¸Šæ ‡ç­¾

**åŒæ­¥ç»“æœé€šçŸ¥ç¤ºä¾‹:**
```
å¤–éƒ¨è”ç³»äººåŒæ­¥å®ŒæˆæŠ¥å‘Šï¼š
ğŸ“Š æ€»è®¡è·å–: 25ä¸ªå¤–éƒ¨è”ç³»äºº
ğŸ” å¾…å¤„ç†: 18ä¸ª (å·²æ’é™¤é‡å¤æ ‡ç­¾)
âœ… æˆåŠŸåŒæ­¥: 15ä¸ª
âŒ åŒæ­¥å¤±è´¥: 3ä¸ª

å¤±è´¥è¯¦æƒ…:
- å¼ ä¸‰1234 [ext_123] - DBä¸­æœªæ‰¾åˆ°åŒ¹é…æ‰‹æœºå·
- æå››5678 [ext_456] - æ‰“æ ‡ç­¾å¤±è´¥
- ç‹äº”9012 [ext_789] - å¤–éƒ¨è”ç³»äººIDä¸ºç©º
```

### è¾…åŠ©æœåŠ¡ä½¿ç”¨åœºæ™¯

#### URLéªŒè¯æœåŠ¡ä½¿ç”¨åœºæ™¯
**é€‚ç”¨æƒ…å†µ:**
- ä¼ä¸šå¾®ä¿¡åº”ç”¨åˆæ¬¡é…ç½®å›è°ƒURLæ—¶
- éœ€è¦ç‹¬ç«‹æµ‹è¯•ä¼ä¸šå¾®ä¿¡å›è°ƒéªŒè¯åŠŸèƒ½
- ä¸»åº”ç”¨éƒ¨ç½²å¤æ‚ï¼Œéœ€è¦ç®€å•çš„éªŒè¯æœåŠ¡

**ä½¿ç”¨æ­¥éª¤:**
1. å¯åŠ¨URLéªŒè¯æœåŠ¡: `cd url_verification && python start.py`
2. é…ç½®ä¼ä¸šå¾®ä¿¡å›è°ƒURL: `https://yourdomain.com/wework-callback`
3. ä¼ä¸šå¾®ä¿¡è‡ªåŠ¨å‘é€éªŒè¯è¯·æ±‚ï¼ŒæœåŠ¡è¿”å›è§£å¯†åçš„echostr
4. éªŒè¯æˆåŠŸåå¯åˆ‡æ¢åˆ°ä¸»åº”ç”¨çš„å›è°ƒå¤„ç†

#### ä»£ç†è½¬å‘æœåŠ¡ä½¿ç”¨åœºæ™¯
**é€‚ç”¨æƒ…å†µ:**
- ä¸»åº”ç”¨éƒ¨ç½²åœ¨å†…ç½‘ï¼Œæ— æ³•ç›´æ¥æ¥æ”¶ä¼ä¸šå¾®ä¿¡å›è°ƒ
- éœ€è¦åœ¨å…¬ç½‘å’Œå†…ç½‘ä¹‹é—´å»ºç«‹å®‰å…¨çš„ä»£ç†é€šé“
- å¤šä¸ªå†…ç½‘æœåŠ¡éœ€è¦ç»Ÿä¸€çš„å…¬ç½‘å…¥å£

**éƒ¨ç½²æ¶æ„:**
```
ä¼ä¸šå¾®ä¿¡æœåŠ¡å™¨
    â†“ HTTPS
å…¬ç½‘æœåŠ¡å™¨ (ä»£ç†è½¬å‘æœåŠ¡)
    â†“ HTTP
å†…ç½‘æœåŠ¡å™¨ (ä¸»åº”ç”¨)
```

**é…ç½®ç¤ºä¾‹:**
```bash
# å…¬ç½‘æœåŠ¡å™¨è¿è¡Œä»£ç†è½¬å‘æœåŠ¡
cd wework_proxy_app
echo "TARGET_SERVER_URL=http://192.168.1.100:8502" > .env
python app.py

# ä¼ä¸šå¾®ä¿¡å›è°ƒURLé…ç½®
https://yourdomain.com/wework-callback/api/v1/wecom/callback
```

## é¡¹ç›®ç»“æ„

```
HR_Project_Bot_2.0/
â”œâ”€â”€ .cursor/rules/          # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ architecture.mdc    # æ¶æ„è®¾è®¡
â”‚   â”œâ”€â”€ prd.mdc            # äº§å“éœ€æ±‚
â”‚   â”œâ”€â”€ procedure.mdc      # æµç¨‹æ–‡æ¡£
â”‚   â””â”€â”€ ...
â”œâ”€â”€ src/                   # æºä»£ç 
â”‚   â”œâ”€â”€ main_ew.py         # ä¼ä¸šå¾®ä¿¡ä¸»åº”ç”¨
â”‚   â”œâ”€â”€ enterprise_wechat_service.py  # ä¼ä¸šå¾®ä¿¡APIæœåŠ¡
â”‚   â”œâ”€â”€ core_processor_ew.py          # æ ¸å¿ƒå¤„ç†å™¨
â”‚   â”œâ”€â”€ handlers/          # ä¸šåŠ¡å¤„ç†å™¨
â”‚   â”œâ”€â”€ models/           # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ processors/       # ä¸“ç”¨å¤„ç†å™¨
â”‚   â”‚   â””â”€â”€ sync_processor.py  # å¤–éƒ¨è”ç³»äººåŒæ­¥å¤„ç†å™¨
â”‚   â”œâ”€â”€ resume_pipeline/  # ç®€å†å¤„ç†ç®¡é“
â”‚   â””â”€â”€ utils/           # å·¥å…·æ¨¡å—
â”œâ”€â”€ url_verification/      # URLéªŒè¯æœåŠ¡
â”‚   â”œâ”€â”€ app.py            # FlaskéªŒè¯åº”ç”¨
â”‚   â”œâ”€â”€ start.py          # å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ crypto_utils.py   # åŠ å¯†è§£å¯†å·¥å…·
â”‚   â”œâ”€â”€ requirements.txt  # ä¾èµ–åˆ—è¡¨
â”‚   â””â”€â”€ README.md         # æœåŠ¡è¯´æ˜
â”œâ”€â”€ wework_proxy_app/     # ä»£ç†è½¬å‘æœåŠ¡
â”‚   â”œâ”€â”€ app.py            # Flaskä»£ç†åº”ç”¨
â”‚   â”œâ”€â”€ requirements.txt  # ä¾èµ–åˆ—è¡¨
â”‚   â””â”€â”€ README.md         # æœåŠ¡è¯´æ˜
â”œâ”€â”€ data/                # å¾…å¤„ç†ç®€å†
â”œâ”€â”€ processed_resumes/   # å·²å¤„ç†ç®€å†
â”œâ”€â”€ tests/              # æµ‹è¯•ç”¨ä¾‹
â”œâ”€â”€ config.yaml         # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ .env               # ç¯å¢ƒå˜é‡
â””â”€â”€ requirements.txt   # Pythonä¾èµ–
```

## éƒ¨ç½²æŒ‡å—

### å¼€å‘ç¯å¢ƒ
1. ä½¿ç”¨å†…ç½‘ç©¿é€å·¥å…· (ngrok/frp) æš´éœ²æœ¬åœ°ç«¯å£
2. é…ç½®ä¼ä¸šå¾®ä¿¡å›è°ƒURLæŒ‡å‘å…¬ç½‘åœ°å€
3. å¯åŠ¨FastAPIåº”ç”¨è¿›è¡Œè°ƒè¯•

### ç”Ÿäº§ç¯å¢ƒ

#### 1. ä¸»åº”ç”¨éƒ¨ç½²
1. **æœåŠ¡å™¨é…ç½®:**
   ```bash
   # ä½¿ç”¨Supervisorç®¡ç†è¿›ç¨‹
   sudo apt install supervisor
   
   # é…ç½®Nginxåå‘ä»£ç†
   sudo apt install nginx
   ```

2. **HTTPSé…ç½®:**
   ```nginx
   server {
       listen 443 ssl;
       server_name your_domain.com;
       
       ssl_certificate /path/to/cert.pem;
       ssl_certificate_key /path/to/key.pem;
       
       location /api/v1/wecom/callback {
           proxy_pass http://127.0.0.1:8502;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
       }
   }
   ```

3. **è¿›ç¨‹ç®¡ç†:**
   ```ini
   [program:hr_bot]
   command=/path/to/.venv/bin/uvicorn src.main_ew:app --host 127.0.0.1 --port 8502
   directory=/path/to/HR_Project_Bot_2.0
   user=hr_bot
   autostart=true
   autorestart=true
   ```

#### 2. URLéªŒè¯æœåŠ¡éƒ¨ç½²
```bash
# éƒ¨ç½²URLéªŒè¯æœåŠ¡
cd url_verification
cp env.example .env
# ç¼–è¾‘.envæ–‡ä»¶é…ç½®ä¼ä¸šå¾®ä¿¡å‚æ•°

# ä½¿ç”¨Supervisorç®¡ç†
sudo tee /etc/supervisor/conf.d/url_verification.conf << EOF
[program:url_verification]
command=/path/to/.venv/bin/python app.py
directory=/path/to/HR_Project_Bot_2.0/url_verification
user=hr_bot
autostart=true
autorestart=true
EOF
```

#### 3. ä»£ç†è½¬å‘æœåŠ¡éƒ¨ç½²
```bash
# éƒ¨ç½²ä»£ç†è½¬å‘æœåŠ¡
cd wework_proxy_app
echo "TARGET_SERVER_URL=http://internal-server:8502" > .env
echo "FLASK_DEBUG=False" >> .env

# ä½¿ç”¨Gunicornè¿è¡Œ
gunicorn -w 4 -b 0.0.0.0:8503 app:app

# Nginxé…ç½®ä»£ç†è½¬å‘
location /wework-callback/ {
    proxy_pass http://127.0.0.1:8503/wework-callback/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}
```

#### 4. éƒ¨ç½²æ¶æ„ç¤ºä¾‹
```
[ä¼ä¸šå¾®ä¿¡] â†’ [å…¬ç½‘åŸŸå+SSL] â†’ [Nginxåå‘ä»£ç†] â†’ [ä»£ç†è½¬å‘æœåŠ¡] â†’ [å†…ç½‘ä¸»åº”ç”¨]
                                    â†“
                              [URLéªŒè¯æœåŠ¡]
```

## ç›‘æ§ä¸ç»´æŠ¤

### æ—¥å¿—ç›‘æ§
*   åº”ç”¨æ—¥å¿—: `logs/app.log`
*   æ–°è¯ä¹¦å‘ç°: `logs/new_certificates.log`
*   é”™è¯¯è¿½è¸ª: è¯¦ç»†çš„å¼‚å¸¸å †æ ˆå’Œä¸Šä¸‹æ–‡ä¿¡æ¯

### æ€§èƒ½ç›‘æ§
*   LLM APIè°ƒç”¨æ¬¡æ•°å’Œè€—æ—¶
*   æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½
*   å¹¶å‘å¤„ç†èƒ½åŠ›
*   çŠ¶æ€ç¼“å­˜å‘½ä¸­ç‡

### å®šæœŸç»´æŠ¤
*   æ£€æŸ¥ `data/error/` å’Œ `data/pending/` ç›®å½•
*   æ›´æ–°è¯ä¹¦ç­‰çº§è§„åˆ™ (`src/utils/ranking_data.py`)
*   ä¼˜åŒ–LLM Promptæå‡è§£æå‡†ç¡®ç‡
*   æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
*   **å¤–éƒ¨è”ç³»äººåŒæ­¥ç»´æŠ¤:**
    *   æ£€æŸ¥ä¼ä¸šå¾®ä¿¡"å·²åŒæ­¥"æ ‡ç­¾æ˜¯å¦å­˜åœ¨
    *   ç›‘æ§åŒæ­¥å¤±è´¥ç‡ï¼ŒåŠæ—¶å¤„ç†æ ¼å¼ä¸è§„èŒƒçš„å¤‡æ³¨
    *   å®šæœŸæ¸…ç†è¿‡æœŸçš„å¤–éƒ¨è”ç³»äººæ•°æ®
    *   éªŒè¯HRç”¨æˆ·æƒé™å’Œå®¢æˆ·è”ç³»æƒé™
*   **è¾…åŠ©æœåŠ¡ç»´æŠ¤:**
    *   ç›‘æ§URLéªŒè¯æœåŠ¡çš„å“åº”æ—¶é—´å’ŒæˆåŠŸç‡
    *   æ£€æŸ¥ä»£ç†è½¬å‘æœåŠ¡çš„è¿æ¥çŠ¶æ€å’Œé”™è¯¯æ—¥å¿—
    *   éªŒè¯ä¼ä¸šå¾®ä¿¡å›è°ƒURLçš„å¯è®¿é—®æ€§
    *   å®šæœŸæ›´æ–°SSLè¯ä¹¦å’ŒåŸŸåé…ç½®


## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚


---

**æ³¨æ„äº‹é¡¹:**
*   ç¡®ä¿ä¼ä¸šå¾®ä¿¡åº”ç”¨é…ç½®æ­£ç¡®
*   å®šæœŸå¤‡ä»½MongoDBæ•°æ®
*   ç›‘æ§LLM APIä½¿ç”¨é‡å’Œæˆæœ¬
*   éµå®ˆæ•°æ®éšç§å’Œå®‰å…¨è§„èŒƒ
*   **å¤–éƒ¨è”ç³»äººåŒæ­¥æ³¨æ„äº‹é¡¹:**
    *   éœ€è¦åœ¨ä¼ä¸šå¾®ä¿¡åå°é¢„å…ˆåˆ›å»º"å·²åŒæ­¥"æ ‡ç­¾
    *   HRç”¨æˆ·å¿…é¡»å…·æœ‰"å®¢æˆ·è”ç³»"æƒé™
    *   å¤–éƒ¨è”ç³»äººå¤‡æ³¨æ ¼å¼éœ€è¦åŒ…å«æœ‰æ•ˆæ‰‹æœºå·
    *   æ³¨æ„ä¼ä¸šå¾®ä¿¡APIè°ƒç”¨é¢‘ç‡é™åˆ¶
    *   å®šæœŸæ£€æŸ¥åŒæ­¥å¤±è´¥çš„è”ç³»äººå¹¶æ‰‹åŠ¨å¤„ç†
*   **è¾…åŠ©æœåŠ¡æ³¨æ„äº‹é¡¹:**
    *   URLéªŒè¯æœåŠ¡çš„TOKENã€ENCODING_AES_KEYã€CORP_IDå¿…é¡»ä¸ä¼ä¸šå¾®ä¿¡åå°é…ç½®ä¸€è‡´
    *   ä»£ç†è½¬å‘æœåŠ¡çš„TARGET_SERVER_URLå¿…é¡»æŒ‡å‘æ­£ç¡®çš„å†…ç½‘æœåŠ¡åœ°å€
    *   ç”Ÿäº§ç¯å¢ƒåŠ¡å¿…å…³é—­è°ƒè¯•æ¨¡å¼ï¼Œä½¿ç”¨HTTPSå’Œåå‘ä»£ç†
    *   ç›‘æ§å„æœåŠ¡çš„ç«¯å£å ç”¨å’Œè¿›ç¨‹çŠ¶æ€
    *   ç¡®ä¿é˜²ç«å¢™è§„åˆ™å…è®¸å¿…è¦çš„ç«¯å£è®¿é—® 